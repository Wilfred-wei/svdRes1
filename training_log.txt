Preparing small-scale balanced dataset...
Creating small dataset at /sda/home/temp/weiwenfei/Datasets/CNNSpot_Split/train_small
Samples per class (real+fake): 200

Processing class: car
  0_real: Copied 100 images
  1_fake: Copied 100 images

Processing class: cat
  0_real: Copied 100 images
  1_fake: Copied 100 images

Processing class: chair
  0_real: Copied 100 images
  1_fake: Copied 100 images

Processing class: horse
  0_real: Copied 100 images
  1_fake: Copied 100 images

✓ Total images copied: 800
✓ Small dataset created at: /sda/home/temp/weiwenfei/Datasets/CNNSpot_Split/train_small

Creating small validation dataset at /sda/home/temp/weiwenfei/Datasets/progan_val_small

Processing class: car
  0_real: Copied 50 images
  1_fake: Copied 50 images

Processing class: cat
  0_real: Copied 50 images
  1_fake: Copied 50 images

Processing class: chair
  0_real: Copied 50 images
  1_fake: Copied 50 images

Processing class: horse
  0_real: Copied 50 images
  1_fake: Copied 50 images

✓ Total validation images copied: 400
Training Stage 1...
/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:29: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = GradScaler()
----------- Configuration Options -----------
FAFormer_head: 2
FAFormer_layers: 2
FAFormer_reduction_factor: 1
WSGM_count: 12
WSGM_reduction_factor: 4
batch_size: 16
eval_data_root: 
eval_stage: 1
experiment_name: training_setting_1_small
input_dir: 
intermediate_model_path: ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
num_workers: 4
output_dir: 
seed: 3407
stage1_batch_size: 16
stage1_epochs: 5
stage1_learning_rate: 5e-05
stage1_lr_decay_factor: 0.7
stage1_lr_decay_step: 2
stage2_batch_size: 8
stage2_epochs: 3
stage2_learning_rate: 2e-06
stage2_lr_decay_factor: 0.7
stage2_lr_decay_step: 2
train_classes: ['car', 'cat', 'chair', 'horse']
train_data_root: /sda/home/temp/weiwenfei/Datasets/CNNSpot_Split/train_small
training_stage: 1
val_classes: ['car', 'cat', 'chair', 'horse']
val_data_root: /sda/home/temp/weiwenfei/Datasets/progan_val_small
weights: ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
---------------------------------------------
Total model parameters: 437.38M
Trainable parameters: 7.10M (1.62%)
Training------------------------------------------------------------
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:01<00:54,  1.12s/it]  4%|▍         | 2/50 [00:01<00:28,  1.71it/s]  6%|▌         | 3/50 [00:01<00:18,  2.54it/s]  8%|▊         | 4/50 [00:01<00:13,  3.35it/s] 10%|█         | 5/50 [00:01<00:11,  3.83it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.48it/s] 14%|█▍        | 7/50 [00:02<00:08,  5.00it/s] 16%|█▌        | 8/50 [00:02<00:07,  5.43it/s] 18%|█▊        | 9/50 [00:02<00:07,  5.23it/s] 20%|██        | 10/50 [00:02<00:07,  5.48it/s] 22%|██▏       | 11/50 [00:02<00:06,  5.69it/s] 24%|██▍       | 12/50 [00:03<00:06,  5.53it/s] 26%|██▌       | 13/50 [00:03<00:06,  5.71it/s] 28%|██▊       | 14/50 [00:03<00:06,  5.77it/s] 30%|███       | 15/50 [00:03<00:06,  5.66it/s] 32%|███▏      | 16/50 [00:03<00:05,  5.79it/s] 34%|███▍      | 17/50 [00:03<00:05,  5.99it/s] 36%|███▌      | 18/50 [00:04<00:05,  6.16it/s] 38%|███▊      | 19/50 [00:04<00:05,  5.78it/s] 40%|████      | 20/50 [00:04<00:05,  5.99it/s] 42%|████▏     | 21/50 [00:04<00:04,  5.97it/s] 44%|████▍     | 22/50 [00:04<00:04,  5.70it/s] 46%|████▌     | 23/50 [00:04<00:04,  5.73it/s] 48%|████▊     | 24/50 [00:05<00:04,  5.90it/s] 50%|█████     | 25/50 [00:05<00:04,  5.86it/s] 52%|█████▏    | 26/50 [00:05<00:04,  5.58it/s] 54%|█████▍    | 27/50 [00:05<00:04,  5.72it/s] 56%|█████▌    | 28/50 [00:05<00:03,  5.81it/s] 58%|█████▊    | 29/50 [00:05<00:03,  5.40it/s] 60%|██████    | 30/50 [00:06<00:03,  5.62it/s] 62%|██████▏   | 31/50 [00:06<00:03,  5.91it/s] 64%|██████▍   | 32/50 [00:06<00:02,  6.03it/s] 66%|██████▌   | 33/50 [00:06<00:02,  5.95it/s] 68%|██████▊   | 34/50 [00:06<00:02,  5.92it/s] 70%|███████   | 35/50 [00:06<00:02,  5.97it/s] 72%|███████▏  | 36/50 [00:07<00:02,  5.98it/s] 74%|███████▍  | 37/50 [00:07<00:02,  5.64it/s] 76%|███████▌  | 38/50 [00:07<00:02,  5.87it/s] 78%|███████▊  | 39/50 [00:07<00:01,  6.07it/s] 80%|████████  | 40/50 [00:07<00:01,  6.14it/s] 82%|████████▏ | 41/50 [00:07<00:01,  5.82it/s] 84%|████████▍ | 42/50 [00:08<00:01,  5.92it/s] 86%|████████▌ | 43/50 [00:08<00:01,  5.86it/s] 88%|████████▊ | 44/50 [00:08<00:01,  5.37it/s] 90%|█████████ | 45/50 [00:08<00:00,  5.67it/s] 92%|█████████▏| 46/50 [00:08<00:00,  5.94it/s] 94%|█████████▍| 47/50 [00:08<00:00,  6.11it/s] 96%|█████████▌| 48/50 [00:09<00:00,  6.05it/s] 98%|█████████▊| 49/50 [00:09<00:00,  6.29it/s]100%|██████████| 50/50 [00:09<00:00,  6.46it/s]100%|██████████| 50/50 [00:09<00:00,  5.22it/s]
Validating************************************************************
  0%|          | 0/25 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:73: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  4%|▍         | 1/25 [00:00<00:10,  2.19it/s] 12%|█▏        | 3/25 [00:00<00:03,  5.73it/s] 20%|██        | 5/25 [00:00<00:02,  8.24it/s] 28%|██▊       | 7/25 [00:00<00:01,  9.83it/s] 36%|███▌      | 9/25 [00:01<00:01, 10.47it/s] 44%|████▍     | 11/25 [00:01<00:01, 11.17it/s] 52%|█████▏    | 13/25 [00:01<00:01, 11.46it/s] 60%|██████    | 15/25 [00:01<00:00, 12.38it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.68it/s] 76%|███████▌  | 19/25 [00:01<00:00, 13.41it/s] 84%|████████▍ | 21/25 [00:01<00:00, 13.99it/s] 92%|█████████▏| 23/25 [00:02<00:00, 14.11it/s]100%|██████████| 25/25 [00:02<00:00, 14.52it/s]100%|██████████| 25/25 [00:02<00:00, 10.16it/s]
2025_12_29_21_03_35
Train Epoch: 1: 
train loss: 0.6482724822035023
val_loss:0.49676685929298403
acc:0.8775
ap:0.976073601042657
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/model_epoch_1.pth
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
Training------------------------------------------------------------
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:26,  1.84it/s]  4%|▍         | 2/50 [00:00<00:14,  3.23it/s]  6%|▌         | 3/50 [00:00<00:11,  4.24it/s]  8%|▊         | 4/50 [00:00<00:09,  4.85it/s] 10%|█         | 5/50 [00:01<00:08,  5.10it/s] 12%|█▏        | 6/50 [00:01<00:08,  5.28it/s] 14%|█▍        | 7/50 [00:01<00:07,  5.39it/s] 16%|█▌        | 8/50 [00:01<00:07,  5.58it/s] 18%|█▊        | 9/50 [00:01<00:07,  5.49it/s] 20%|██        | 10/50 [00:02<00:07,  5.57it/s] 22%|██▏       | 11/50 [00:02<00:06,  5.57it/s] 24%|██▍       | 12/50 [00:02<00:06,  5.58it/s] 26%|██▌       | 13/50 [00:02<00:06,  5.54it/s] 28%|██▊       | 14/50 [00:02<00:06,  5.55it/s] 30%|███       | 15/50 [00:02<00:06,  5.52it/s] 32%|███▏      | 16/50 [00:03<00:06,  5.62it/s] 34%|███▍      | 17/50 [00:03<00:05,  5.56it/s] 36%|███▌      | 18/50 [00:03<00:05,  5.47it/s] 38%|███▊      | 19/50 [00:03<00:05,  5.40it/s] 40%|████      | 20/50 [00:03<00:05,  5.41it/s] 42%|████▏     | 21/50 [00:04<00:05,  5.43it/s] 44%|████▍     | 22/50 [00:04<00:05,  5.46it/s] 46%|████▌     | 23/50 [00:04<00:04,  5.47it/s] 48%|████▊     | 24/50 [00:04<00:04,  5.31it/s] 50%|█████     | 25/50 [00:04<00:04,  5.50it/s] 52%|█████▏    | 26/50 [00:04<00:04,  5.55it/s] 54%|█████▍    | 27/50 [00:05<00:04,  5.70it/s] 56%|█████▌    | 28/50 [00:05<00:03,  5.62it/s] 58%|█████▊    | 29/50 [00:05<00:03,  5.63it/s] 60%|██████    | 30/50 [00:05<00:03,  5.61it/s] 62%|██████▏   | 31/50 [00:05<00:03,  5.45it/s] 64%|██████▍   | 32/50 [00:06<00:03,  5.49it/s] 66%|██████▌   | 33/50 [00:06<00:03,  5.45it/s] 68%|██████▊   | 34/50 [00:06<00:02,  5.46it/s] 70%|███████   | 35/50 [00:06<00:02,  5.45it/s] 72%|███████▏  | 36/50 [00:06<00:02,  5.54it/s] 74%|███████▍  | 37/50 [00:06<00:02,  5.54it/s] 76%|███████▌  | 38/50 [00:07<00:02,  5.67it/s] 78%|███████▊  | 39/50 [00:07<00:01,  5.69it/s] 80%|████████  | 40/50 [00:07<00:01,  5.78it/s] 82%|████████▏ | 41/50 [00:07<00:01,  5.86it/s] 84%|████████▍ | 42/50 [00:07<00:01,  5.83it/s] 86%|████████▌ | 43/50 [00:07<00:01,  5.89it/s] 88%|████████▊ | 44/50 [00:08<00:01,  5.77it/s] 90%|█████████ | 45/50 [00:08<00:00,  5.73it/s] 92%|█████████▏| 46/50 [00:08<00:00,  5.72it/s] 94%|█████████▍| 47/50 [00:08<00:00,  5.62it/s] 96%|█████████▌| 48/50 [00:08<00:00,  5.49it/s] 98%|█████████▊| 49/50 [00:09<00:00,  5.66it/s]100%|██████████| 50/50 [00:09<00:00,  5.79it/s]100%|██████████| 50/50 [00:09<00:00,  5.36it/s]
Validating************************************************************
  0%|          | 0/25 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:73: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  4%|▍         | 1/25 [00:00<00:07,  3.03it/s] 12%|█▏        | 3/25 [00:00<00:03,  7.25it/s] 20%|██        | 5/25 [00:00<00:02,  8.88it/s] 28%|██▊       | 7/25 [00:00<00:01, 10.28it/s] 36%|███▌      | 9/25 [00:00<00:01, 11.38it/s] 44%|████▍     | 11/25 [00:01<00:01, 11.11it/s] 52%|█████▏    | 13/25 [00:01<00:01, 11.80it/s] 60%|██████    | 15/25 [00:01<00:00, 12.35it/s] 68%|██████▊   | 17/25 [00:01<00:00, 11.86it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.23it/s] 84%|████████▍ | 21/25 [00:01<00:00, 11.87it/s] 92%|█████████▏| 23/25 [00:02<00:00, 12.31it/s]100%|██████████| 25/25 [00:02<00:00, 11.74it/s]100%|██████████| 25/25 [00:02<00:00, 10.49it/s]
2025_12_29_21_03_55
Train Epoch: 2: 
train loss: 0.2067551110852875
val_loss:0.014634126983582973
acc:0.9975
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/model_epoch_2.pth
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
Training------------------------------------------------------------
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:27,  1.80it/s]  4%|▍         | 2/50 [00:00<00:16,  2.96it/s]  6%|▌         | 3/50 [00:00<00:11,  3.93it/s]  8%|▊         | 4/50 [00:01<00:09,  4.63it/s] 10%|█         | 5/50 [00:01<00:09,  4.98it/s] 12%|█▏        | 6/50 [00:01<00:08,  4.95it/s] 14%|█▍        | 7/50 [00:01<00:08,  5.15it/s] 16%|█▌        | 8/50 [00:01<00:07,  5.38it/s] 18%|█▊        | 9/50 [00:01<00:07,  5.26it/s] 20%|██        | 10/50 [00:02<00:07,  5.53it/s] 22%|██▏       | 11/50 [00:02<00:07,  5.34it/s] 24%|██▍       | 12/50 [00:02<00:07,  5.20it/s] 26%|██▌       | 13/50 [00:02<00:06,  5.42it/s] 28%|██▊       | 14/50 [00:02<00:06,  5.37it/s] 30%|███       | 15/50 [00:03<00:06,  5.55it/s] 32%|███▏      | 16/50 [00:03<00:05,  5.85it/s] 34%|███▍      | 17/50 [00:03<00:05,  5.56it/s] 36%|███▌      | 18/50 [00:03<00:05,  5.75it/s] 38%|███▊      | 19/50 [00:03<00:05,  5.31it/s] 40%|████      | 20/50 [00:03<00:05,  5.40it/s] 42%|████▏     | 21/50 [00:04<00:05,  5.33it/s] 44%|████▍     | 22/50 [00:04<00:05,  5.57it/s] 46%|████▌     | 23/50 [00:04<00:04,  5.46it/s] 48%|████▊     | 24/50 [00:04<00:04,  5.60it/s] 50%|█████     | 25/50 [00:04<00:04,  5.84it/s] 52%|█████▏    | 26/50 [00:05<00:04,  5.61it/s] 54%|█████▍    | 27/50 [00:05<00:04,  5.66it/s] 56%|█████▌    | 28/50 [00:05<00:03,  5.73it/s] 58%|█████▊    | 29/50 [00:05<00:03,  5.42it/s] 60%|██████    | 30/50 [00:05<00:03,  5.67it/s] 62%|██████▏   | 31/50 [00:05<00:03,  5.93it/s] 64%|██████▍   | 32/50 [00:06<00:03,  5.87it/s] 66%|██████▌   | 33/50 [00:06<00:02,  5.78it/s] 68%|██████▊   | 34/50 [00:06<00:02,  5.77it/s] 70%|███████   | 35/50 [00:06<00:02,  5.33it/s] 72%|███████▏  | 36/50 [00:06<00:02,  5.57it/s] 74%|███████▍  | 37/50 [00:07<00:02,  5.43it/s] 76%|███████▌  | 38/50 [00:07<00:02,  5.74it/s] 78%|███████▊  | 39/50 [00:07<00:01,  5.64it/s] 80%|████████  | 40/50 [00:07<00:01,  5.83it/s] 82%|████████▏ | 41/50 [00:07<00:01,  6.03it/s] 84%|████████▍ | 42/50 [00:07<00:01,  6.19it/s] 86%|████████▌ | 43/50 [00:07<00:01,  5.80it/s] 88%|████████▊ | 44/50 [00:08<00:00,  6.03it/s] 90%|█████████ | 45/50 [00:08<00:00,  6.20it/s] 92%|█████████▏| 46/50 [00:08<00:00,  6.19it/s] 94%|█████████▍| 47/50 [00:08<00:00,  5.95it/s] 96%|█████████▌| 48/50 [00:08<00:00,  6.13it/s] 98%|█████████▊| 49/50 [00:08<00:00,  6.26it/s]100%|██████████| 50/50 [00:09<00:00,  5.71it/s]100%|██████████| 50/50 [00:09<00:00,  5.38it/s]
Validating************************************************************
  0%|          | 0/25 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:73: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  4%|▍         | 1/25 [00:00<00:09,  2.59it/s]  8%|▊         | 2/25 [00:00<00:05,  4.52it/s] 16%|█▌        | 4/25 [00:00<00:02,  7.25it/s] 24%|██▍       | 6/25 [00:00<00:02,  9.47it/s] 32%|███▏      | 8/25 [00:00<00:01, 10.64it/s] 40%|████      | 10/25 [00:01<00:01, 10.87it/s] 48%|████▊     | 12/25 [00:01<00:01, 11.59it/s] 56%|█████▌    | 14/25 [00:01<00:00, 12.50it/s] 64%|██████▍   | 16/25 [00:01<00:00, 12.16it/s] 72%|███████▏  | 18/25 [00:01<00:00, 12.91it/s] 80%|████████  | 20/25 [00:01<00:00, 13.25it/s] 88%|████████▊ | 22/25 [00:02<00:00, 13.17it/s] 96%|█████████▌| 24/25 [00:02<00:00, 12.20it/s]100%|██████████| 25/25 [00:02<00:00, 10.21it/s]
2025_12_29_21_05_03
Train Epoch: 3: 
train loss: 0.005743351892805567
val_loss:0.0030090205930173395
acc:1.0
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/model_epoch_3.pth
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
Training------------------------------------------------------------
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:23,  2.12it/s]  4%|▍         | 2/50 [00:00<00:15,  3.16it/s]  6%|▌         | 3/50 [00:00<00:12,  3.77it/s]  8%|▊         | 4/50 [00:01<00:11,  4.14it/s] 10%|█         | 5/50 [00:01<00:10,  4.37it/s] 12%|█▏        | 6/50 [00:01<00:09,  4.49it/s] 14%|█▍        | 7/50 [00:01<00:09,  4.48it/s] 16%|█▌        | 8/50 [00:01<00:08,  4.76it/s] 18%|█▊        | 9/50 [00:02<00:08,  4.84it/s] 20%|██        | 10/50 [00:02<00:07,  5.10it/s] 22%|██▏       | 11/50 [00:02<00:07,  4.92it/s] 24%|██▍       | 12/50 [00:02<00:07,  5.08it/s] 26%|██▌       | 13/50 [00:02<00:07,  5.08it/s] 28%|██▊       | 14/50 [00:03<00:07,  4.99it/s] 30%|███       | 15/50 [00:03<00:07,  4.92it/s] 32%|███▏      | 16/50 [00:03<00:06,  4.94it/s] 34%|███▍      | 17/50 [00:03<00:06,  5.10it/s] 36%|███▌      | 18/50 [00:03<00:06,  4.99it/s] 38%|███▊      | 19/50 [00:04<00:06,  4.92it/s] 40%|████      | 20/50 [00:04<00:06,  4.87it/s] 42%|████▏     | 21/50 [00:04<00:06,  4.79it/s] 44%|████▍     | 22/50 [00:04<00:05,  4.98it/s] 46%|████▌     | 23/50 [00:04<00:05,  4.91it/s] 48%|████▊     | 24/50 [00:05<00:05,  4.84it/s] 50%|█████     | 25/50 [00:05<00:05,  4.81it/s] 52%|█████▏    | 26/50 [00:05<00:05,  4.78it/s] 54%|█████▍    | 27/50 [00:05<00:04,  4.77it/s] 56%|█████▌    | 28/50 [00:05<00:04,  4.81it/s] 58%|█████▊    | 29/50 [00:06<00:04,  4.91it/s] 60%|██████    | 30/50 [00:06<00:04,  4.86it/s] 62%|██████▏   | 31/50 [00:06<00:03,  4.98it/s] 64%|██████▍   | 32/50 [00:06<00:03,  4.88it/s] 66%|██████▌   | 33/50 [00:07<00:03,  4.70it/s] 68%|██████▊   | 34/50 [00:07<00:03,  4.71it/s] 70%|███████   | 35/50 [00:07<00:03,  4.70it/s] 72%|███████▏  | 36/50 [00:07<00:02,  4.71it/s] 74%|███████▍  | 37/50 [00:07<00:02,  4.81it/s] 76%|███████▌  | 38/50 [00:08<00:02,  4.88it/s] 78%|███████▊  | 39/50 [00:08<00:02,  5.00it/s] 80%|████████  | 40/50 [00:08<00:02,  4.92it/s] 82%|████████▏ | 41/50 [00:08<00:01,  4.85it/s] 84%|████████▍ | 42/50 [00:08<00:01,  4.81it/s] 86%|████████▌ | 43/50 [00:09<00:01,  4.78it/s] 88%|████████▊ | 44/50 [00:09<00:01,  4.62it/s] 90%|█████████ | 45/50 [00:09<00:01,  4.76it/s] 92%|█████████▏| 46/50 [00:09<00:00,  4.99it/s] 94%|█████████▍| 47/50 [00:09<00:00,  4.91it/s] 96%|█████████▌| 48/50 [00:10<00:00,  5.18it/s] 98%|█████████▊| 49/50 [00:10<00:00,  5.05it/s]100%|██████████| 50/50 [00:10<00:00,  4.92it/s]100%|██████████| 50/50 [00:10<00:00,  4.73it/s]
Validating************************************************************
  0%|          | 0/25 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:73: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  4%|▍         | 1/25 [00:00<00:08,  2.93it/s] 12%|█▏        | 3/25 [00:00<00:03,  7.26it/s] 20%|██        | 5/25 [00:00<00:02,  9.68it/s] 28%|██▊       | 7/25 [00:00<00:01, 10.23it/s] 36%|███▌      | 9/25 [00:00<00:01, 11.68it/s] 44%|████▍     | 11/25 [00:01<00:01, 12.76it/s] 52%|█████▏    | 13/25 [00:01<00:00, 12.26it/s] 60%|██████    | 15/25 [00:01<00:00, 12.48it/s] 68%|██████▊   | 17/25 [00:01<00:00, 13.23it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.95it/s] 84%|████████▍ | 21/25 [00:01<00:00, 13.14it/s] 92%|█████████▏| 23/25 [00:01<00:00, 13.37it/s]100%|██████████| 25/25 [00:02<00:00, 12.70it/s]100%|██████████| 25/25 [00:02<00:00, 10.89it/s]
2025_12_29_21_06_23
Train Epoch: 4: 
train loss: 0.002840101979125072
val_loss:0.06118463660124689
acc:0.9875
ap:0.9988903743895613
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/model_epoch_4.pth
Training------------------------------------------------------------
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:20,  2.43it/s]  4%|▍         | 2/50 [00:00<00:12,  3.85it/s]  6%|▌         | 3/50 [00:00<00:10,  4.61it/s]  8%|▊         | 4/50 [00:00<00:09,  5.02it/s] 10%|█         | 5/50 [00:01<00:08,  5.35it/s] 12%|█▏        | 6/50 [00:01<00:07,  5.70it/s] 14%|█▍        | 7/50 [00:01<00:07,  5.76it/s] 16%|█▌        | 8/50 [00:01<00:07,  5.96it/s] 18%|█▊        | 9/50 [00:01<00:06,  5.87it/s] 20%|██        | 10/50 [00:01<00:06,  6.03it/s] 22%|██▏       | 11/50 [00:02<00:06,  5.72it/s] 24%|██▍       | 12/50 [00:02<00:06,  5.83it/s] 26%|██▌       | 13/50 [00:02<00:06,  6.03it/s] 28%|██▊       | 14/50 [00:02<00:05,  6.00it/s] 30%|███       | 15/50 [00:02<00:05,  6.19it/s] 32%|███▏      | 16/50 [00:02<00:05,  6.13it/s] 34%|███▍      | 17/50 [00:03<00:05,  6.09it/s] 36%|███▌      | 18/50 [00:03<00:05,  6.17it/s] 38%|███▊      | 19/50 [00:03<00:04,  6.29it/s] 40%|████      | 20/50 [00:03<00:04,  6.23it/s] 42%|████▏     | 21/50 [00:03<00:04,  6.20it/s] 44%|████▍     | 22/50 [00:03<00:04,  5.89it/s] 46%|████▌     | 23/50 [00:04<00:04,  6.00it/s] 48%|████▊     | 24/50 [00:04<00:04,  6.16it/s] 50%|█████     | 25/50 [00:04<00:03,  6.38it/s] 52%|█████▏    | 26/50 [00:04<00:03,  6.30it/s] 54%|█████▍    | 27/50 [00:04<00:03,  6.30it/s] 56%|█████▌    | 28/50 [00:04<00:03,  6.28it/s] 58%|█████▊    | 29/50 [00:04<00:03,  6.18it/s] 60%|██████    | 30/50 [00:05<00:03,  6.13it/s] 62%|██████▏   | 31/50 [00:05<00:03,  6.24it/s] 64%|██████▍   | 32/50 [00:05<00:02,  6.22it/s] 66%|██████▌   | 33/50 [00:05<00:02,  6.18it/s] 68%|██████▊   | 34/50 [00:05<00:02,  6.14it/s] 70%|███████   | 35/50 [00:05<00:02,  6.15it/s] 72%|███████▏  | 36/50 [00:06<00:02,  6.25it/s] 74%|███████▍  | 37/50 [00:06<00:02,  6.25it/s] 76%|███████▌  | 38/50 [00:06<00:01,  6.07it/s] 78%|███████▊  | 39/50 [00:06<00:01,  6.01it/s] 80%|████████  | 40/50 [00:06<00:01,  6.18it/s] 82%|████████▏ | 41/50 [00:06<00:01,  6.29it/s] 84%|████████▍ | 42/50 [00:07<00:01,  6.22it/s] 86%|████████▌ | 43/50 [00:07<00:01,  6.32it/s] 88%|████████▊ | 44/50 [00:07<00:00,  6.41it/s] 90%|█████████ | 45/50 [00:07<00:00,  6.33it/s] 92%|█████████▏| 46/50 [00:07<00:00,  6.40it/s] 94%|█████████▍| 47/50 [00:07<00:00,  6.45it/s] 96%|█████████▌| 48/50 [00:08<00:00,  6.27it/s] 98%|█████████▊| 49/50 [00:08<00:00,  6.34it/s]100%|██████████| 50/50 [00:08<00:00,  6.22it/s]100%|██████████| 50/50 [00:08<00:00,  5.92it/s]
Validating************************************************************
  0%|          | 0/25 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage1.py:73: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  4%|▍         | 1/25 [00:00<00:08,  2.77it/s] 12%|█▏        | 3/25 [00:00<00:03,  6.41it/s] 20%|██        | 5/25 [00:00<00:02,  9.12it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.03it/s] 36%|███▌      | 9/25 [00:00<00:01, 11.93it/s] 44%|████▍     | 11/25 [00:01<00:01, 12.88it/s] 52%|█████▏    | 13/25 [00:01<00:00, 13.15it/s] 60%|██████    | 15/25 [00:01<00:00, 13.75it/s] 68%|██████▊   | 17/25 [00:01<00:00, 14.27it/s] 76%|███████▌  | 19/25 [00:01<00:00, 14.13it/s] 84%|████████▍ | 21/25 [00:01<00:00, 14.51it/s] 92%|█████████▏| 23/25 [00:01<00:00, 14.28it/s]100%|██████████| 25/25 [00:02<00:00, 14.08it/s]100%|██████████| 25/25 [00:02<00:00, 11.40it/s]
2025_12_29_21_06_39
Train Epoch: 5: 
train loss: 0.002718040274510927
val_loss:0.001508307526819408
acc:1.0
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/model_epoch_5.pth
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
Training complete.
Training Stage 2...
/sda/home/temp/weiwenfei/ForgeLens-res/models/network/net_stage2.py:65: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_load = torch.load(opt.intermediate_model_path)
/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:30: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = GradScaler()
----------- Configuration Options -----------
FAFormer_head: 2
FAFormer_layers: 2
FAFormer_reduction_factor: 1
WSGM_count: 12
WSGM_reduction_factor: 4
batch_size: 16
eval_data_root: 
eval_stage: 1
experiment_name: training_setting_1_small
input_dir: 
intermediate_model_path: ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
num_workers: 4
output_dir: 
seed: 3407
stage1_batch_size: 16
stage1_epochs: 5
stage1_learning_rate: 5e-05
stage1_lr_decay_factor: 0.7
stage1_lr_decay_step: 2
stage2_batch_size: 8
stage2_epochs: 3
stage2_learning_rate: 2e-06
stage2_lr_decay_factor: 0.7
stage2_lr_decay_step: 2
train_classes: ['car', 'cat', 'chair', 'horse']
train_data_root: /sda/home/temp/weiwenfei/Datasets/CNNSpot_Split/train_small
training_stage: 2
val_classes: ['car', 'cat', 'chair', 'horse']
val_data_root: /sda/home/temp/weiwenfei/Datasets/progan_val_small
weights: ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth
---------------------------------------------
LOAD ./check_points/training_setting_1_small/train_stage_1/model/intermediate_model_best.pth!!!!!!
Total model parameters: 444.47M
Trainable parameters: 7.10M (1.60%)
Training------------------------------------------------------------
  0%|          | 0/100 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:48: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  1%|          | 1/100 [00:01<02:14,  1.36s/it]  4%|▍         | 4/100 [00:01<00:28,  3.41it/s]  7%|▋         | 7/100 [00:01<00:14,  6.30it/s] 10%|█         | 10/100 [00:01<00:09,  9.25it/s] 13%|█▎        | 13/100 [00:01<00:07, 12.13it/s] 16%|█▌        | 16/100 [00:01<00:05, 14.76it/s] 19%|█▉        | 19/100 [00:02<00:04, 16.75it/s] 22%|██▏       | 22/100 [00:02<00:04, 18.54it/s] 25%|██▌       | 25/100 [00:02<00:03, 20.05it/s] 28%|██▊       | 28/100 [00:02<00:03, 21.25it/s] 31%|███       | 31/100 [00:02<00:03, 21.53it/s] 34%|███▍      | 34/100 [00:02<00:02, 22.06it/s] 37%|███▋      | 37/100 [00:02<00:02, 22.00it/s] 40%|████      | 40/100 [00:03<00:02, 22.52it/s] 43%|████▎     | 43/100 [00:03<00:02, 22.43it/s] 46%|████▌     | 46/100 [00:03<00:02, 21.20it/s] 49%|████▉     | 49/100 [00:03<00:02, 20.01it/s] 52%|█████▏    | 52/100 [00:03<00:02, 20.81it/s] 55%|█████▌    | 55/100 [00:03<00:02, 21.39it/s] 58%|█████▊    | 58/100 [00:03<00:01, 21.90it/s] 61%|██████    | 61/100 [00:04<00:01, 20.94it/s] 64%|██████▍   | 64/100 [00:04<00:01, 20.57it/s] 67%|██████▋   | 67/100 [00:04<00:01, 21.35it/s] 70%|███████   | 70/100 [00:04<00:01, 21.28it/s] 73%|███████▎  | 73/100 [00:04<00:01, 19.68it/s] 76%|███████▌  | 76/100 [00:04<00:01, 20.37it/s] 79%|███████▉  | 79/100 [00:04<00:01, 19.73it/s] 81%|████████  | 81/100 [00:05<00:00, 19.40it/s] 83%|████████▎ | 83/100 [00:05<00:00, 17.90it/s] 86%|████████▌ | 86/100 [00:05<00:00, 19.60it/s] 89%|████████▉ | 89/100 [00:05<00:00, 20.88it/s] 92%|█████████▏| 92/100 [00:05<00:00, 21.75it/s] 95%|█████████▌| 95/100 [00:05<00:00, 22.49it/s] 98%|█████████▊| 98/100 [00:05<00:00, 23.04it/s]100%|██████████| 100/100 [00:06<00:00, 16.46it/s]
Validating************************************************************
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:74: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:20,  2.37it/s]  8%|▊         | 4/50 [00:00<00:05,  8.35it/s] 12%|█▏        | 6/50 [00:00<00:03, 11.08it/s] 18%|█▊        | 9/50 [00:00<00:02, 15.01it/s] 24%|██▍       | 12/50 [00:00<00:02, 17.55it/s] 30%|███       | 15/50 [00:01<00:01, 19.89it/s] 36%|███▌      | 18/50 [00:01<00:01, 21.51it/s] 42%|████▏     | 21/50 [00:01<00:01, 22.71it/s] 48%|████▊     | 24/50 [00:01<00:01, 22.80it/s] 54%|█████▍    | 27/50 [00:01<00:00, 23.64it/s] 60%|██████    | 30/50 [00:01<00:00, 24.25it/s] 66%|██████▌   | 33/50 [00:01<00:00, 24.18it/s] 72%|███████▏  | 36/50 [00:01<00:00, 23.03it/s] 78%|███████▊  | 39/50 [00:02<00:00, 23.16it/s] 84%|████████▍ | 42/50 [00:02<00:00, 23.81it/s] 90%|█████████ | 45/50 [00:02<00:00, 23.13it/s] 96%|█████████▌| 48/50 [00:02<00:00, 23.08it/s]100%|██████████| 50/50 [00:02<00:00, 18.95it/s]
2025_12_29_21_09_27
Train Epoch: 1: 
train loss: 0.5094334438885793
val_loss:0.24234236359596253
acc:1.0
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_2/model/model_best_val_loss.pth
Training------------------------------------------------------------
  0%|          | 0/100 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:48: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  1%|          | 1/100 [00:00<00:30,  3.27it/s]  4%|▍         | 4/100 [00:00<00:08, 10.94it/s]  7%|▋         | 7/100 [00:00<00:06, 15.43it/s] 10%|█         | 10/100 [00:00<00:04, 18.30it/s] 13%|█▎        | 13/100 [00:00<00:04, 20.22it/s] 16%|█▌        | 16/100 [00:00<00:03, 21.56it/s] 19%|█▉        | 19/100 [00:01<00:03, 22.44it/s] 22%|██▏       | 22/100 [00:01<00:03, 23.09it/s] 25%|██▌       | 25/100 [00:01<00:03, 23.53it/s] 28%|██▊       | 28/100 [00:01<00:03, 23.60it/s] 31%|███       | 31/100 [00:01<00:03, 22.98it/s] 34%|███▍      | 34/100 [00:01<00:03, 21.66it/s] 37%|███▋      | 37/100 [00:01<00:02, 22.19it/s] 40%|████      | 40/100 [00:01<00:02, 22.77it/s] 43%|████▎     | 43/100 [00:02<00:02, 22.45it/s] 46%|████▌     | 46/100 [00:02<00:02, 22.41it/s] 49%|████▉     | 49/100 [00:02<00:02, 22.97it/s] 52%|█████▏    | 52/100 [00:02<00:02, 23.35it/s] 55%|█████▌    | 55/100 [00:02<00:01, 23.63it/s] 58%|█████▊    | 58/100 [00:02<00:01, 23.83it/s] 61%|██████    | 61/100 [00:02<00:01, 23.81it/s] 64%|██████▍   | 64/100 [00:02<00:01, 23.80it/s] 67%|██████▋   | 67/100 [00:03<00:01, 23.71it/s] 70%|███████   | 70/100 [00:03<00:01, 23.40it/s] 73%|███████▎  | 73/100 [00:03<00:01, 23.66it/s] 76%|███████▌  | 76/100 [00:03<00:01, 23.84it/s] 79%|███████▉  | 79/100 [00:03<00:00, 24.00it/s] 82%|████████▏ | 82/100 [00:03<00:00, 24.08it/s] 85%|████████▌ | 85/100 [00:03<00:00, 23.14it/s] 88%|████████▊ | 88/100 [00:04<00:00, 23.39it/s] 91%|█████████ | 91/100 [00:04<00:00, 23.59it/s] 94%|█████████▍| 94/100 [00:04<00:00, 23.81it/s] 97%|█████████▋| 97/100 [00:04<00:00, 23.97it/s]100%|██████████| 100/100 [00:04<00:00, 23.22it/s]100%|██████████| 100/100 [00:04<00:00, 21.50it/s]
Validating************************************************************
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:74: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:19,  2.57it/s]  8%|▊         | 4/50 [00:00<00:04,  9.49it/s] 14%|█▍        | 7/50 [00:00<00:03, 14.12it/s] 20%|██        | 10/50 [00:00<00:02, 17.54it/s] 26%|██▌       | 13/50 [00:00<00:01, 19.99it/s] 32%|███▏      | 16/50 [00:00<00:01, 21.68it/s] 38%|███▊      | 19/50 [00:01<00:01, 22.81it/s] 44%|████▍     | 22/50 [00:01<00:01, 23.59it/s] 50%|█████     | 25/50 [00:01<00:01, 24.23it/s] 56%|█████▌    | 28/50 [00:01<00:00, 24.64it/s] 62%|██████▏   | 31/50 [00:01<00:00, 24.94it/s] 68%|██████▊   | 34/50 [00:01<00:00, 25.19it/s] 74%|███████▍  | 37/50 [00:01<00:00, 25.38it/s] 80%|████████  | 40/50 [00:01<00:00, 25.45it/s] 86%|████████▌ | 43/50 [00:02<00:00, 25.55it/s] 92%|█████████▏| 46/50 [00:02<00:00, 25.60it/s] 98%|█████████▊| 49/50 [00:02<00:00, 25.66it/s]100%|██████████| 50/50 [00:02<00:00, 20.54it/s]
2025_12_29_21_09_39
Train Epoch: 2: 
train loss: 0.15608440287927589
val_loss:0.04121921911835671
acc:1.0
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_2/model/model_best_val_loss.pth
Training------------------------------------------------------------
  0%|          | 0/100 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:48: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  1%|          | 1/100 [00:00<01:12,  1.37it/s]  3%|▎         | 3/100 [00:00<00:22,  4.40it/s]  5%|▌         | 5/100 [00:00<00:13,  7.02it/s]  7%|▋         | 7/100 [00:01<00:09,  9.59it/s]  9%|▉         | 9/100 [00:01<00:08, 10.99it/s] 11%|█         | 11/100 [00:01<00:06, 12.74it/s] 13%|█▎        | 13/100 [00:01<00:08, 10.20it/s] 15%|█▌        | 15/100 [00:01<00:07, 11.32it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.26it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.59it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.07it/s] 24%|██▍       | 24/100 [00:02<00:07, 10.51it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.27it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.68it/s] 30%|███       | 30/100 [00:03<00:10,  6.88it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.40it/s] 34%|███▍      | 34/100 [00:04<00:06,  9.49it/s] 36%|███▌      | 36/100 [00:04<00:05, 11.13it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.89it/s] 40%|████      | 40/100 [00:04<00:06,  9.42it/s] 42%|████▏     | 42/100 [00:04<00:05, 10.88it/s] 44%|████▍     | 44/100 [00:04<00:04, 11.86it/s] 47%|████▋     | 47/100 [00:05<00:03, 14.18it/s] 49%|████▉     | 49/100 [00:05<00:03, 15.35it/s] 51%|█████     | 51/100 [00:05<00:04, 11.14it/s] 54%|█████▍    | 54/100 [00:05<00:04, 10.93it/s] 56%|█████▌    | 56/100 [00:05<00:03, 12.17it/s] 58%|█████▊    | 58/100 [00:05<00:03, 12.73it/s] 60%|██████    | 60/100 [00:06<00:03, 13.31it/s] 62%|██████▏   | 62/100 [00:06<00:02, 14.48it/s] 64%|██████▍   | 64/100 [00:06<00:02, 14.69it/s] 66%|██████▌   | 66/100 [00:06<00:02, 15.76it/s] 68%|██████▊   | 68/100 [00:06<00:02, 15.53it/s] 71%|███████   | 71/100 [00:06<00:01, 16.35it/s] 73%|███████▎  | 73/100 [00:06<00:01, 16.78it/s] 76%|███████▌  | 76/100 [00:07<00:01, 18.16it/s] 78%|███████▊  | 78/100 [00:07<00:01, 18.14it/s] 80%|████████  | 80/100 [00:07<00:01, 17.71it/s] 83%|████████▎ | 83/100 [00:07<00:00, 19.00it/s] 85%|████████▌ | 85/100 [00:07<00:00, 19.22it/s] 87%|████████▋ | 87/100 [00:07<00:00, 18.21it/s] 89%|████████▉ | 89/100 [00:07<00:00, 18.12it/s] 92%|█████████▏| 92/100 [00:07<00:00, 19.05it/s] 95%|█████████▌| 95/100 [00:08<00:00, 19.47it/s] 97%|█████████▋| 97/100 [00:08<00:00, 18.30it/s] 99%|█████████▉| 99/100 [00:08<00:00, 18.51it/s]100%|██████████| 100/100 [00:08<00:00, 11.78it/s]
Validating************************************************************
  0%|          | 0/50 [00:00<?, ?it/s]/sda/home/temp/weiwenfei/ForgeLens-res/models/trainer_stage2.py:74: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
  2%|▏         | 1/50 [00:00<00:33,  1.48it/s]  8%|▊         | 4/50 [00:00<00:08,  5.44it/s] 14%|█▍        | 7/50 [00:01<00:04,  9.00it/s] 18%|█▊        | 9/50 [00:01<00:03, 10.61it/s] 22%|██▏       | 11/50 [00:01<00:03, 12.41it/s] 26%|██▌       | 13/50 [00:01<00:03, 10.84it/s] 32%|███▏      | 16/50 [00:01<00:02, 13.63it/s] 36%|███▌      | 18/50 [00:01<00:02, 14.25it/s] 42%|████▏     | 21/50 [00:01<00:01, 15.91it/s] 46%|████▌     | 23/50 [00:02<00:01, 16.39it/s] 52%|█████▏    | 26/50 [00:02<00:01, 16.98it/s] 56%|█████▌    | 28/50 [00:02<00:01, 17.57it/s] 60%|██████    | 30/50 [00:02<00:01, 17.83it/s] 64%|██████▍   | 32/50 [00:02<00:00, 18.01it/s] 70%|███████   | 35/50 [00:02<00:00, 19.42it/s] 76%|███████▌  | 38/50 [00:02<00:00, 20.20it/s] 82%|████████▏ | 41/50 [00:02<00:00, 17.80it/s] 88%|████████▊ | 44/50 [00:03<00:00, 18.99it/s] 94%|█████████▍| 47/50 [00:03<00:00, 19.90it/s]100%|██████████| 50/50 [00:03<00:00, 19.47it/s]100%|██████████| 50/50 [00:03<00:00, 14.10it/s]
2025_12_29_21_11_07
Train Epoch: 3: 
train loss: 0.053253966134668575
val_loss:0.020567725710570813
acc:1.0
ap:1.0
Model checkpoint saved to ./check_points/training_setting_1_small/train_stage_2/model/model_best_val_loss.pth
Training complete.
Training completed!
You can evaluate the model using:
python evaluate.py --experiment_name training_setting_1_small --eval_data_root /sda/home/temp/weiwenfei/Datasets/CnnDetTest --eval_stage 2 --WSGM_count 12 --WSGM_reduction_factor 4 --FAFormer_layers 2 --FAFormer_reduction_factor 1 --FAFormer_head 2 --num_workers 4 --seed 3407
